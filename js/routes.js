/**
 * Route GeoJSON data for Ruse Transit Map
 * Approximate routes based on known streets and landmarks
 */

const ROUTE_GEOMETRIES = {
    // Trolleybus Line 2: ж.к. Дружба 3 - Център - ж.к. Чародейка
    'T2': {
        type: 'LineString',
        coordinates: [
            [25.9178, 43.8345],  // ж.к. Дружба 3
            [25.9212, 43.8356],  // Блок 18
            [25.9256, 43.8378],  // Трети март
            [25.9289, 43.8395],  // Св. Георги
            [25.9345, 43.8423],  // бул. Липник
            [25.9389, 43.8445],  // Мосю Бриколаж
            [25.9412, 43.8456],  // Кауфланд
            [25.9445, 43.8467],  // Найден Киров
            [25.9489, 43.8478],  // Олимп
            [25.9534, 43.8489],  // Подстанция
            [25.9567, 43.8495],  // Мол Русе
            [25.9534, 43.8489],  // пл. Оборище
            [25.9512, 43.8467],  // бул. Цар Освободител
            [25.9489, 43.8423],  // Печатни платки
            [25.9456, 43.8378],  // бул. Христо Ботев
            [25.9432, 43.8312],  // ж.к. Чародейка
        ]
    },

    // Trolleybus Line 9: ж.к. Чародейка - Център - ж.к. Дружба 1
    'T9': {
        type: 'LineString',
        coordinates: [
            [25.9456, 43.8235],  // ж.к. Чародейка Юг
            [25.9467, 43.8256],  // Търговски комплекс
            [25.9478, 43.8289],  // ул. Тодор Икономов
            [25.9489, 43.8312],  // бул. Васил Левски
            [25.9478, 43.8345],  // Блок 115
            [25.9489, 43.8378],  // Печатни платки
            [25.9512, 43.8412],  // бул. Цар Освободител
            [25.9534, 43.8445],  // Училище Йордан Йовков
            [25.9534, 43.8489],  // пл. Оборище
            [25.9456, 43.8467],  // бул. Липник
            [25.9378, 43.8423],  // Дружба 1
            [25.9312, 43.8412],  // Спортна зала
        ]
    },

    // Trolleybus Line 13: Гара Разпределителна - Център - ж.к. Дружба 2
    'T13': {
        type: 'LineString',
        coordinates: [
            [25.9834, 43.8567],  // Гара Разпределителна
            [25.9789, 43.8545],  // Автогара Изток
            [25.9745, 43.8523],  // ул. Иван Ведър
            [25.9689, 43.8512],  // Печатница Дунав
            [25.9623, 43.8495],  // Мол Русе
            [25.9578, 43.8489],  // Подстанция
            [25.9534, 43.8478],  // Олимп
            [25.9489, 43.8467],  // Найден Киров
            [25.9445, 43.8456],  // Кауфланд
            [25.9389, 43.8445],  // бул. Липник
            [25.9312, 43.8412],  // ж.к. Дружба 2
            [25.9256, 43.8395],  // Блок 56
        ]
    },

    // Trolleybus Line 21: ж.к. Чародейка Юг - Гара Разпределителна
    'T21': {
        type: 'LineString',
        coordinates: [
            [25.9456, 43.8235],  // ж.к. Чародейка Юг
            [25.9478, 43.8267],  // ул. Тодор Икономов
            [25.9489, 43.8298],  // бул. Васил Левски
            [25.9478, 43.8334],  // Блок 115
            [25.9467, 43.8367],  // бул. Христо Ботев
            [25.9489, 43.8389],  // Печатни платки
            [25.9512, 43.8423],  // бул. Цар Освободител
            [25.9534, 43.8456],  // Училище Й. Йовков
            [25.9534, 43.8489],  // пл. Оборище
            [25.9489, 43.8478],  // бул. Липник
            [25.9423, 43.8467],  // Мосю Бриколаж
            [25.9456, 43.8478],  // Кауфланд
            [25.9489, 43.8489],  // Найден Киров
            [25.9534, 43.8495],  // Олимп
            [25.9567, 43.8501],  // Подстанция
            [25.9612, 43.8512],  // Мол Русе
            [25.9656, 43.8523],  // Печатница Дунав
            [25.9712, 43.8534],  // ул. Иван Ведър
            [25.9767, 43.8545],  // Автогара Изток
            [25.9834, 43.8567],  // Гара Разпределителна
        ]
    },

    // Trolleybus Line 24: ж.к. Дружба 3 - Център - Централна ЖП гара
    'T24': {
        type: 'LineString',
        coordinates: [
            [25.9178, 43.8345],  // ж.к. Дружба 3 (Блок 45)
            [25.9145, 43.8312],  // Хиподрум
            [25.9189, 43.8378],  // бул. България
            [25.9245, 43.8423],  // Левента
            [25.9289, 43.8456],  // Алеко Константинов
            [25.9378, 43.8512],  // бул. Мидия Енос
            [25.9567, 43.8589],  // Централна ЖП гара
            [25.9612, 43.8567],  // ул. Борисова
            [25.9589, 43.8534],  // Лермонтов
            [25.9567, 43.8512],  // Орхидея
            [25.9545, 43.8489],  // Медицински център
            [25.9534, 43.8467],  // бул. Ген. Скобелев
            [25.9523, 43.8456],  // СБА (Скобелев)
            [25.9534, 43.8489],  // пл. Оборище
        ]
    },

    // Trolleybus Line 27: пл. Оборище - Окръжна болница - Русенски университет
    'T27': {
        type: 'LineString',
        coordinates: [
            [25.9534, 43.8489],  // пл. Оборище
            [25.9567, 43.8478],  // Спортна зала ОЗК Арена
            [25.9612, 43.8489],  // Пантеона
            [25.9656, 43.8501],  // бул. Съединение
            [25.9689, 43.8512],  // Парк на Възрожденците
            [25.9734, 43.8523],  // Окръжна болница
            [25.9778, 43.8545],  // ул. Плиска
            [25.9823, 43.8567],  // Първа пролет
            [25.9878, 43.8589],  // Русенски университет
            [25.9912, 43.8612],  // кв. Париж
            [25.9956, 43.8634],  // ж.к. Цветница
        ]
    },

    // Trolleybus Line 29: ж.к. Чародейка Юг - Захарен завод
    'T29': {
        type: 'LineString',
        coordinates: [
            [25.9456, 43.8235],  // ж.к. Чародейка Юг
            [25.9489, 43.8312],  // бул. Васил Левски
            [25.9489, 43.8378],  // Печатни платки
            [25.9534, 43.8489],  // пл. Оборище
            [25.9567, 43.8478],  // Спортна зала
            [25.9612, 43.8489],  // Пантеона
            [25.9734, 43.8523],  // Окръжна болница
            [25.9878, 43.8589],  // Русенски университет
            [25.9956, 43.8634],  // ж.к. Цветница
            [26.0023, 43.8678],  // бул. Тутракан
            [26.0067, 43.8712],  // ж.к. Тракция (ЛВЗ)
            [26.0089, 43.8734],  // Психодиспансер
            [26.0123, 43.8756],  // Захарен завод
        ]
    },

    // Bus Line 6: Дом на културата - Асфалтова база
    'B6': {
        type: 'LineString',
        coordinates: [
            [25.9589, 43.8512],  // Дом на културата
            [25.9534, 43.8489],  // пл. Оборище
            [25.9456, 43.8467],  // бул. Липник
            [25.9412, 43.8456],  // Кауфланд
            [25.9345, 43.8478],  // Индустриален парк
            [25.9278, 43.8512],  // Асфалтова база - Запад
        ]
    },

    // Bus Line 11: кв. Мальовица - Дунав мост (full route)
    'B11': {
        type: 'LineString',
        coordinates: [
            [25.8923, 43.8212],  // Мальовица
            [25.8967, 43.8234],  // ул. Мальовица
            [25.9012, 43.8256],  // ул. Тинтява
            [25.9067, 43.8289],  // бул. Гоце Делчев
            [25.9112, 43.8312],  // Помпена станция
            [25.9156, 43.8334],  // бул. България
            [25.9189, 43.8356],  // Верила
            [25.9223, 43.8378],  // Левента
            [25.9267, 43.8401],  // Училище Алеко Константинов
            [25.9312, 43.8423],  // п.в. Охлюва
            [25.9367, 43.8456],  // ул. Стефан Стамболов
            [25.9412, 43.8489],  // бул. Мидия Енос
            [25.9478, 43.8534],  // ж.к. Мидия Енос
            [25.9567, 43.8589],  // Централна ЖП гара
            [25.9612, 43.8567],  // ул. Борисова
            [25.9589, 43.8534],  // Лермонтов
            [25.9567, 43.8512],  // Орхидея
            [25.9545, 43.8489],  // Медицински център
            [25.9534, 43.8467],  // бул. Ген. Скобелев
            [25.9534, 43.8489],  // пл. Оборище
            [25.9567, 43.8478],  // Спортна зала ОЗК Арена
            [25.9612, 43.8489],  // Пантеона
            [25.9656, 43.8501],  // бул. Съединение
            [25.9689, 43.8512],  // ул. Св. Наум
            [25.9734, 43.8523],  // Окръжна болница
            [25.9778, 43.8545],  // ул. Плиска
            [25.9823, 43.8567],  // Първа пролет
            [25.9878, 43.8589],  // Русенски университет
            [25.9912, 43.8612],  // Париж
            [25.9956, 43.8634],  // ж.к. Цветница
            [26.0023, 43.8678],  // бул. Тутракан
            [26.0067, 43.8712],  // ж.к. Тракция (ЛВЗ)
            [26.0089, 43.8734],  // Психодиспансер
            [26.0123, 43.8756],  // Захарен завод
            [26.0156, 43.8778],  // ПГ по транспорт
            [26.0189, 43.8823],  // Еконт Експрес
            [26.0234, 43.8912],  // Митница (Дунав мост)
        ]
    },

    // Bus Line 12: Централна ЖП гара - Захарен завод
    'B12': {
        type: 'LineString',
        coordinates: [
            [25.9567, 43.8589],  // Централна ЖП гара
            [25.9478, 43.8556],  // бул. Мидия Енос
            [25.9423, 43.8512],  // ул. Стефан Стамболов
            [25.9378, 43.8467],  // бул. България
            [25.9334, 43.8423],  // Левента
            [25.9267, 43.8378],  // ж.к. Дружба 3
            [25.9212, 43.8345],  // Хиподрум
            [25.9312, 43.8412],  // бул. Тутракан
            [25.9534, 43.8534],  // ж.к. Цветница
            [25.9756, 43.8623],  // Русенски университет
            [25.9923, 43.8689],  // ж.к. Тракция
            [26.0045, 43.8723],  // Психодиспансер
            [26.0123, 43.8756],  // Захарен завод
        ]
    },

    // Bus Line 15: кв. Долапите - Централна ЖП гара
    'B15': {
        type: 'LineString',
        coordinates: [
            [25.9234, 43.8534],  // кв. Долапите
            [25.9289, 43.8512],  // ул. Димитър Басарбовски
            [25.9378, 43.8489],  // бул. Липник
            [25.9456, 43.8489],  // пл. Оборище
            [25.9512, 43.8534],  // бул. Цар Освободител
            [25.9567, 43.8589],  // Централна ЖП гара
        ]
    },

    // Bus Line 18: Хиподрум - ж.к. Дружба 3 (circular via center)
    'B18': {
        type: 'LineString',
        coordinates: [
            [25.9145, 43.8312],  // Хиподрум
            [25.9189, 43.8356],  // бул. България
            [25.9234, 43.8401],  // Левента
            [25.9278, 43.8445],  // Алеко Константинов
            [25.9345, 43.8489],  // бул. Мидия Енос
            [25.9456, 43.8534],  // Централна ЖП гара
            [25.9512, 43.8512],  // ул. Борисова
            [25.9489, 43.8489],  // Лермонтов
            [25.9467, 43.8467],  // Орхидея
            [25.9456, 43.8456],  // бул. Ген. Скобелев
            [25.9489, 43.8478],  // пл. Оборище
            [25.9456, 43.8467],  // бул. Липник
            [25.9412, 43.8456],  // Кауфланд
            [25.9378, 43.8445],  // Мосю Бриколаж
            [25.9334, 43.8423],  // ж.к. Дружба 1
            [25.9289, 43.8401],  // ж.к. Дружба 2
            [25.9245, 43.8378],  // ж.к. Дружба 3
            [25.9178, 43.8345],  // Блок 45
        ]
    },

    // Bus Line 19: Метро - Кооперативен пазар
    'B19': {
        type: 'LineString',
        coordinates: [
            [25.9367, 43.8423],  // Метро
            [25.9412, 43.8445],  // бул. Липник
            [25.9456, 43.8456],  // Кауфланд
            [25.9489, 43.8467],  // Олимп
            [25.9534, 43.8478],  // Мол Русе
            [25.9534, 43.8489],  // пл. Оборище
            [25.9512, 43.8467],  // бул. Цар Освободител
            [25.9489, 43.8445],  // Училище Й. Йовков
            [25.9467, 43.8423],  // Кооперативен пазар
        ]
    },

    // Bus Line 20: Гимназия по корабостроене - ж.к. Изток
    'B20': {
        type: 'LineString',
        coordinates: [
            [25.9623, 43.8612],  // Гимназия по корабостроене
            [25.9589, 43.8578],  // Пристанище
            [25.9556, 43.8534],  // бул. Цар Освободител
            [25.9534, 43.8489],  // пл. Оборище
            [25.9578, 43.8456],  // Автогара Юг
            [25.9623, 43.8423],  // ж.к. Изток
            [25.9656, 43.8389],  // пл. Прага - Юг
        ]
    },

    // Bus Line 23: ж.к. Дружба 3 - пл. Хан Крум
    'B23': {
        type: 'LineString',
        coordinates: [
            [25.9178, 43.8345],  // ж.к. Дружба 3
            [25.9234, 43.8378],  // ж.к. Дружба 2
            [25.9289, 43.8401],  // ж.к. Дружба 1
            [25.9378, 43.8445],  // бул. Липник
            [25.9456, 43.8489],  // пл. Оборище
            [25.9512, 43.8512],  // Център
            [25.9567, 43.8534],  // пл. Хан Крум
        ]
    },

    // Bus Line 28: ж.к. Дружба 3 - Индустриален парк
    'B28': {
        type: 'LineString',
        coordinates: [
            [25.9178, 43.8345],  // ж.к. Дружба 3
            [25.9334, 43.8423],  // бул. Липник
            [25.9456, 43.8489],  // пл. Оборище
            [25.9534, 43.8478],  // Спортна зала ОЗК Арена
            [25.9589, 43.8489],  // Пантеона
            [25.9689, 43.8523],  // Окръжна болница
            [25.9823, 43.8589],  // Русенски университет
            [25.9912, 43.8634],  // ж.к. Цветница
            [25.9978, 43.8678],  // Кероес
            [26.0034, 43.8712],  // Индустриален парк
        ]
    },

    // Bus Line 30: ж.к. Чародейка - Център
    'B30': {
        type: 'LineString',
        coordinates: [
            [25.9432, 43.8279],  // ж.к. Чародейка
            [25.9456, 43.8334],  // бул. Христо Ботев
            [25.9478, 43.8378],  // Печатни платки
            [25.9489, 43.8412],  // Хотел Рига
            [25.9512, 43.8456],  // бул. Цар Освободител
            [25.9534, 43.8489],  // пл. Оборище
            [25.9556, 43.8512],  // Център
        ]
    },

    // Bus Line 33: Гара Разпределителна - Образцов чифлик
    'B33': {
        type: 'LineString',
        coordinates: [
            [25.9834, 43.8567],  // Гара Разпределителна
            [25.9789, 43.8545],  // Автогара Изток
            [25.9612, 43.8512],  // бул. Липник
            [25.9534, 43.8489],  // пл. Оборище
            [25.9567, 43.8534],  // Централна ЖП гара
            [25.9689, 43.8612],  // кв. Образцов чифлик
        ]
    },

    // Simplified routes for other bus lines
    'B3': {
        type: 'LineString',
        coordinates: [
            [25.9534, 43.8489],  // пл. Оборище
            [25.9578, 43.8534],  // бул. Цар Освободител
            [25.9623, 43.8589],  // Пристанище
            [25.9689, 43.8634],  // кв. Средна кула
        ]
    },

    'B4': {
        type: 'LineString',
        coordinates: [
            [25.9567, 43.8589],  // Централна ЖП гара
            [25.9534, 43.8534],  // пл. Оборище
            [25.9712, 43.8545],  // Автогара Изток
            [25.9823, 43.8578],  // Източна промишлена зона
        ]
    },

    'B5': {
        type: 'LineString',
        coordinates: [
            [25.9567, 43.8589],  // Централна ЖП гара
            [25.9612, 43.8567],  // бул. Борисова
            [25.9689, 43.8612],  // кв. Образцов чифлик
        ]
    },

    'B8': {
        type: 'LineString',
        coordinates: [
            [25.9534, 43.8489],  // пл. Оборище
            [25.9467, 43.8512],  // бул. Цар Освободител
            [25.9345, 43.8534],  // Западна промишлена зона
        ]
    },

    'B10': {
        type: 'LineString',
        coordinates: [
            [25.9567, 43.8589],  // Централна ЖП гара
            [25.9534, 43.8534],  // пл. Оборище
            [25.9456, 43.8578],  // кв. Здравец
        ]
    },

    'B16': {
        type: 'LineString',
        coordinates: [
            [25.9834, 43.8567],  // Гара Разпределителна
            [25.9756, 43.8545],  // Автогара Изток
            [25.9534, 43.8512],  // бул. Липник
            [25.9345, 43.8534],  // кв. Долапите
            [25.9234, 43.8567],  // Петролна база
        ]
    }
};

/**
 * Stop markers data with coordinates
 * Key stops across the network
 */
const STOP_MARKERS = [
    // Main interchanges
    { name: 'пл. Оборище', lat: 43.8489, lng: 25.9534, type: 'major', lines: ['T2', 'T9', 'T13', 'T21', 'T24', 'T27', 'B6', 'B11', 'B15', 'B18', 'B19', 'B23', 'B28', 'B30', 'B33'] },
    { name: 'Централна ЖП гара', lat: 43.8589, lng: 25.9567, type: 'major', lines: ['T24', 'B4', 'B5', 'B10', 'B11', 'B12', 'B15', 'B18', 'B33'] },
    { name: 'Мол Русе', lat: 43.8495, lng: 25.9567, type: 'major', lines: ['T2', 'T13', 'T21', 'B19'] },
    { name: 'Автогара Изток', lat: 43.8545, lng: 25.9789, type: 'major', lines: ['T13', 'T21', 'B4', 'B16', 'B33'] },

    // Residential areas
    { name: 'ж.к. Чародейка', lat: 43.8312, lng: 25.9432, type: 'terminal', lines: ['T2', 'T9', 'B30'] },
    { name: 'ж.к. Чародейка Юг', lat: 43.8235, lng: 25.9456, type: 'terminal', lines: ['T21', 'T29'] },
    { name: 'ж.к. Дружба 1', lat: 43.8412, lng: 25.9312, type: 'regular', lines: ['T9', 'B18', 'B23'] },
    { name: 'ж.к. Дружба 2', lat: 43.8378, lng: 25.9245, type: 'regular', lines: ['T13', 'B18', 'B23'] },
    { name: 'ж.к. Дружба 3', lat: 43.8345, lng: 25.9178, type: 'terminal', lines: ['T2', 'T24', 'B12', 'B18', 'B23', 'B28'] },
    { name: 'ж.к. Цветница', lat: 43.8634, lng: 25.9956, type: 'regular', lines: ['T27', 'T29', 'B11', 'B12', 'B28'] },

    // Important stops
    { name: 'Кауфланд', lat: 43.8456, lng: 25.9412, type: 'regular', lines: ['T2', 'T13', 'T21', 'B6', 'B18', 'B19'] },
    { name: 'бул. Липник', lat: 43.8467, lng: 25.9456, type: 'regular', lines: ['T2', 'T9', 'T13', 'T21', 'B6', 'B15', 'B16', 'B18', 'B19', 'B23', 'B28', 'B33'] },
    { name: 'Русенски университет', lat: 43.8589, lng: 25.9878, type: 'major', lines: ['T27', 'T29', 'B11', 'B12', 'B28'] },
    { name: 'Окръжна болница', lat: 43.8523, lng: 25.9734, type: 'major', lines: ['T27', 'T29', 'B11', 'B28'] },
    { name: 'Захарен завод', lat: 43.8756, lng: 26.0123, type: 'terminal', lines: ['T29', 'B11', 'B12'] },
    { name: 'Гара Разпределителна', lat: 43.8567, lng: 25.9834, type: 'terminal', lines: ['T13', 'T21', 'B16', 'B33'] },
    { name: 'Дунав мост', lat: 43.8912, lng: 26.0234, type: 'terminal', lines: ['B11'] },
    { name: 'Хиподрум', lat: 43.8312, lng: 25.9145, type: 'regular', lines: ['T24', 'B12', 'B18'] },
    { name: 'Спортна зала ОЗК Арена', lat: 43.8478, lng: 25.9567, type: 'regular', lines: ['T24', 'T27', 'T29', 'B11', 'B28'] },
    { name: 'Пантеона', lat: 43.8489, lng: 25.9612, type: 'regular', lines: ['T24', 'T27', 'T29', 'B11', 'B28'] },

    // Additional stops
    { name: 'Метро', lat: 43.8423, lng: 25.9367, type: 'regular', lines: ['B19'] },
    { name: 'кв. Долапите', lat: 43.8534, lng: 25.9234, type: 'terminal', lines: ['B15', 'B16'] },
    { name: 'Дом на културата', lat: 43.8512, lng: 25.9589, type: 'regular', lines: ['B6'] },
    { name: 'Печатни платки', lat: 43.8378, lng: 25.9489, type: 'regular', lines: ['T2', 'T9', 'T21', 'T29', 'B30'] },
    { name: 'Олимп', lat: 43.8478, lng: 25.9489, type: 'regular', lines: ['T2', 'T13', 'T21', 'B19'] },
];

/**
 * Create GeoJSON FeatureCollection for all routes
 */
function createRoutesGeoJSON() {
    const features = [];

    // Add trolleybus routes
    TRANSIT_DATA.trolleybusLines.forEach(line => {
        if (ROUTE_GEOMETRIES[line.id]) {
            features.push({
                type: 'Feature',
                properties: {
                    id: line.id,
                    number: line.number,
                    name: line.name,
                    type: 'trolleybus',
                    route: line.route,
                    color: line.color
                },
                geometry: ROUTE_GEOMETRIES[line.id]
            });
        }
    });

    // Add bus routes
    TRANSIT_DATA.busLines.forEach(line => {
        if (ROUTE_GEOMETRIES[line.id]) {
            features.push({
                type: 'Feature',
                properties: {
                    id: line.id,
                    number: line.number,
                    name: line.name,
                    type: 'bus',
                    route: line.route,
                    color: line.color
                },
                geometry: ROUTE_GEOMETRIES[line.id]
            });
        }
    });

    return {
        type: 'FeatureCollection',
        features: features
    };
}

/**
 * Create GeoJSON FeatureCollection for stops
 */
function createStopsGeoJSON() {
    return {
        type: 'FeatureCollection',
        features: STOP_MARKERS.map(stop => ({
            type: 'Feature',
            properties: {
                name: stop.name,
                type: stop.type,
                lines: stop.lines
            },
            geometry: {
                type: 'Point',
                coordinates: [stop.lng, stop.lat]
            }
        }))
    };
}

// Export for use in other modules
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { ROUTE_GEOMETRIES, STOP_MARKERS, createRoutesGeoJSON, createStopsGeoJSON };
}
